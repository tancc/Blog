<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JS中的物件導向 | Tan&#39;s note</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="這幾天重新認識了JS中物件導向的一些概念，尤其是prototype這塊的概念。在ES6中加入了class但並不代表JS就有了類別，他只是個語法糖背後還是prototype-based，而且使用class背後其實還會有一些隱憂存在著，若一開始就直接使用class其實會對JS有一些錯誤的認知(我就是這樣…)，而使用class以什麼缺點，以後可能會再寫一篇來紀錄。
本文章內容包括

JS中的原型物件導向">
<meta property="og:type" content="article">
<meta property="og:title" content="JS中的物件導向">
<meta property="og:url" content="http://tancc.github.io/blog/2016/01/24/javascript-oo/index.html">
<meta property="og:site_name" content="Tan's note">
<meta property="og:description" content="這幾天重新認識了JS中物件導向的一些概念，尤其是prototype這塊的概念。在ES6中加入了class但並不代表JS就有了類別，他只是個語法糖背後還是prototype-based，而且使用class背後其實還會有一些隱憂存在著，若一開始就直接使用class其實會對JS有一些錯誤的認知(我就是這樣…)，而使用class以什麼缺點，以後可能會再寫一篇來紀錄。
本文章內容包括

JS中的原型物件導向">
<meta property="og:updated_time" content="2016-05-15T07:41:20.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JS中的物件導向">
<meta name="twitter:description" content="這幾天重新認識了JS中物件導向的一些概念，尤其是prototype這塊的概念。在ES6中加入了class但並不代表JS就有了類別，他只是個語法糖背後還是prototype-based，而且使用class背後其實還會有一些隱憂存在著，若一開始就直接使用class其實會對JS有一些錯誤的認知(我就是這樣…)，而使用class以什麼缺點，以後可能會再寫一篇來紀錄。
本文章內容包括

JS中的原型物件導向">
  
    <link rel="alternate" href="/atom.xml" title="Tan&#39;s note" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/blog" id="logo">Tan&#39;s note</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/blog">Home</a>
        
          <a class="main-nav-link" href="/blog/blog/archives">Archives</a>
        
          <a class="main-nav-link" href="https://github.com/tancc">Github</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://tancc.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-javascript-oo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2016/01/24/javascript-oo/" class="article-date">
  <time datetime="2016-01-23T16:09:16.000Z" itemprop="datePublished">2016-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JS中的物件導向
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <p>這幾天重新認識了JS中物件導向的一些概念，尤其是prototype這塊的概念。<br>在ES6中加入了<code>class</code>但並不代表JS就有了<code>類別</code>，他只是個語法糖背後還是prototype-based，而且使用<code>class</code>背後其實還會有一些隱憂存在著，若一開始就直接使用<code>class</code>其實會對JS有一些錯誤的認知(我就是這樣…)，而使用<code>class</code>以什麼缺點，以後可能會再寫一篇來紀錄。</p>
<p>本文章內容包括</p>
<ul>
<li>JS中的原型物件導向</li>
<li>對prototype有簡單認識</li>
<li>JS中OO的不同寫法</li>
</ul>
<hr>
<p>在JS中要使用類別這概念時常會這樣做<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.talk = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hi I am '</span> + <span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Man</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  Person.call(<span class="keyword">this</span>, name)</span><br><span class="line">&#125;</span><br><span class="line">Man.prototype = <span class="built_in">Object</span>.create(Person.prototype) <span class="comment">//比使用new Person()好，後面會說到</span></span><br><span class="line">Man.prototype.howOld = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.age &#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Man(<span class="string">'Max'</span>, <span class="number">12</span>)</span><br><span class="line">a.talk()</span><br></pre></td></tr></table></figure></p>
<p>一般會說“建立了一個Person類別，建立一個繼承Person類別的Man類別，執行Man的建構式來產生實體給a”<br>其中有幾點需要注意</p>
<ul>
<li><h2 id="JS不是class-based而是prototype-based，並沒有類別"><a href="#JS不是class-based而是prototype-based，並沒有類別" class="headerlink" title="JS不是class-based而是prototype-based，並沒有類別"></a>JS不是class-based而是prototype-based，並沒有類別</h2></li>
<li><h2 id="JS物件導向中，用的是prototypal-inheritance而不是classical-inheritance"><a href="#JS物件導向中，用的是prototypal-inheritance而不是classical-inheritance" class="headerlink" title="JS物件導向中，用的是prototypal inheritance而不是classical inheritance"></a>JS物件導向中，用的是prototypal inheritance而不是classical inheritance</h2></li>
<li><h2 id="JS中並沒有建構式，只有函式"><a href="#JS中並沒有建構式，只有函式" class="headerlink" title="JS中並沒有建構式，只有函式"></a>JS中並沒有建構式，只有函式</h2></li>
</ul>
<p><code>new</code>到底做了什麼<br>當一個函式使用new來呼叫時通常會稱此函式為”建構式”，但其實他也是一般的函式罷了，只是呼叫的方式不同是。<code>new</code>其實在背後做了幾個動作(程式碼僅為方便理解，不是真的完全這樣做的)</p>
<ul>
<li><h4 id="建立出一個新的空object"><a href="#建立出一個新的空object" class="headerlink" title="建立出一個新的空object"></a>建立出一個新的空object</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object = &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="建立此object的prototype-chain"><a href="#建立此object的prototype-chain" class="headerlink" title="建立此object的prototype-chain"></a>建立此object的prototype-chain</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object.__proto__ = Man.prototype</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="將此object作為function其context，透過this初始化properties-Man-call-object-someparams"><a href="#將此object作為function其context，透過this初始化properties-Man-call-object-someparams" class="headerlink" title="將此object作為function其context，透過this初始化properties (Man.call(object, [,someparams]))"></a>將此object作為function其context，透過this初始化properties (Man.call(object, [,someparams]))</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Man.call(object, <span class="string">'Max'</span>, <span class="number">12</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="若”constructor”此函式沒有回傳任何值，此新物件即為回傳值"><a href="#若”constructor”此函式沒有回傳任何值，此新物件即為回傳值" class="headerlink" title="若”constructor”此函式沒有回傳任何值，此新物件即為回傳值"></a>若”constructor”此函式沒有回傳任何值，此新物件即為回傳值</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = object;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h1 id="prototype-（原型）"><a href="#prototype-（原型）" class="headerlink" title="prototype （原型）"></a>prototype （原型）</h1><p>首先，prototype是JS中很重要的概念。那prototype是什麼？小弟我無法作很詳細的解釋，GOOGLE上也都有滿多說明的。而我認為它主要的用意是在解決”Shared Behavior”的問題，透過delegate prototype，建立起prototype-chain，達到”prototypal” inheritance。</p>
<p>class-based的語言物件導向是創建class，而此類別就像是一個藍圖，藉由“複製”藍圖來產生sub-class再將其複製來產生instance。而prototype-based的語言如JS，並不用這種類似”複製”的手法，而是將某物件的原型委託(delegation)給另個物件使用（上述<code>new</code>的第二個行為），也就是物件連接著另一個物件，產生prototype link(delegation link)，達到繼承的效果，其實本質上是不一樣的。</p>
<p>JS中，基本上每個物件都有他的prototype，以<code>Object.getPrototypeOf( obj )</code>或是<code>obj.__proto___</code>取得<br>而每個函式都會有個<code>prototype</code>這個屬性，以<code>funcName.prototype</code>取得</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dog = &#123;name: <span class="string">'Max'</span>&#125;</span><br><span class="line">dog.__proto__ <span class="comment">// &#123;&#125; 會看到空物件的原因是裡面的屬性都是not enumeratable</span></span><br><span class="line">dog.hasOwnProperty(<span class="string">"name"</span>) <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>為何dog沒有<code>hasOwnProperty</code>這個函式卻可以使用呢？原因是所有物件一被定義時他的<code>__proto__</code>都是指向<code>Object.prototype</code>，而<code>hasOwnProperty</code>這是Object原型內的函式，也就是所有的物件都跟<code>Object.prototype</code>有所連接。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dog.__proto__ === <span class="built_in">Object</span>.prototype</span><br><span class="line"><span class="comment">//連結關係</span></span><br><span class="line">dog</span><br><span class="line">|_ name</span><br><span class="line">|_ __proto__ =&gt; Objec.prototype</span><br><span class="line">                |_ hasOwnProperty</span><br><span class="line">                |_ __proto__ =&gt; <span class="literal">null</span></span><br><span class="line"><span class="comment">//順帶一提Object.prototype的原型會為null</span></span><br></pre></td></tr></table></figure></p>
<p>而JS中Array和Function也是物件，或者你可以想成“特殊物件”，所以他們也跟 <code>Object.prototype</code>有所連結<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="comment">//連結關係</span></span><br><span class="line">arr</span><br><span class="line">|_ <span class="number">0</span></span><br><span class="line">|_ <span class="number">1</span></span><br><span class="line">|_ <span class="number">2</span></span><br><span class="line">|_ length</span><br><span class="line">|_ __proto__ =&gt; <span class="built_in">Array</span>.prototype</span><br><span class="line">                |- ...</span><br><span class="line">                |_ __proto__ =&gt; Objec.prototype</span><br><span class="line">                                |_ __proto__ =&gt; <span class="literal">null</span></span><br><span class="line"><span class="comment">//因此就算arr沒有定義其他函式，他也能使用map, reduce, filter等等在Array.prototype中的函式</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//連結關係</span></span><br><span class="line">foo</span><br><span class="line">|_ __proto__ =&gt; <span class="built_in">Function</span>.prototype</span><br><span class="line">                |_ ...</span><br><span class="line">                |_ __proto__ =&gt; Objec.prototype</span><br><span class="line">                                |_ __proto__ =&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
<p>而函式剛定義時其prototype為空物件<code>{}</code>，我們可以在上面定義各種屬性，以讓繼承他的物件可以共用這些東西，就如同<code>Object</code>上的<code>prototype</code>定義了許多函式供其他物件使用。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Car.prototype <span class="comment">//&#123;&#125;</span></span><br><span class="line">Car.prototype.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;</span><br><span class="line">Car.prototype.stop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;</span><br><span class="line">...</span><br><span class="line">var c = <span class="keyword">new</span> Car()</span><br><span class="line">c.run() <span class="comment">// 物件c可以run</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="prototype-chain"><a href="#prototype-chain" class="headerlink" title="prototype chain"></a>prototype chain</h1><p>而在一開頭的範例中，為何Man中的屬性以及prototype中都沒有定義<code>talk</code>此函式，物件a卻可以呼叫呢？</p>
<p>範例中執行<code>a.talk()</code>時，會先從他的物件去找有無talk，若沒有就會去看prototype中是否有talk，若沒有再往上一層prototype去找，依序為<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a                     ---&gt; &#123;age: 12, name: &quot;Max&quot;&#125;,沒有talk</span><br><span class="line">a.__proto__           ---&gt; &#123;howOld: function(), __proto__: Person.prototype&#125;</span><br><span class="line">a.__proto__.__proto__ ---&gt; &#123;talk: function(),__proto__: Object&#125; 找到talk了！</span><br></pre></td></tr></table></figure></p>
<p>哇a什麼時候多了<code>__proto__</code>而且他的裡面也還有<code>__proto__</code>！？<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Man(<span class="string">'Max'</span>, <span class="number">12</span>)</span><br></pre></td></tr></table></figure></p>
<p>這行背後進行了上面說過的那四件行為。<br>首先建立出一個新個物件，還記得說過每個物件都有<code>__proto__</code>這屬性嗎？再來將此<code>__proto__</code>參照到以<code>new</code>呼叫的函式其<code>prototype</code>，也就是<code>Man.prototype</code>。再來將此物件作為function Man中的context使用<code>this</code>去初始其他屬性，最後將這個物件回傳給a。因此可以明白為何能使用<code>a.__proto__</code>，以及其顯示出的內容了吧。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Man.prototype = <span class="built_in">Object</span>.create(Person.prototype)</span><br><span class="line"><span class="comment">//也許你會使用以下較不好的方法來達成此任務</span></span><br><span class="line"><span class="comment">//Man.prototype = Person.prototype</span></span><br><span class="line"><span class="comment">//Man.prototype = new Person()</span></span><br></pre></td></tr></table></figure>
<p>還記得每個函式一被宣告出來後就會有<code>prototype</code>這空物件<code>{}</code>嗎？而上面程式碼<code>Object.create(...)</code>背後的動作為，先建立一個新的物件，將此物件的<code>__proto__</code>參照到<code>Person.prototype</code>這個物件，最後將<code>Man.prototype</code>的空物件用此新物件替換掉（聽起來有點拗口ＸＤ）。也就因為如此我們才能用<code>a.__proto__.__proto__</code>去找到<code>Person.prototype</code>中定義的talk函式！</p>
<p>至此就能稍微體會JS中的prototypal inheritance了吧！就是藉由物件間原型的參照來達成繼承。而串連了許多物件後，這prototype的連結就是prototype chain。</p>
<p>物件存取某屬性時，就是從物件本身的property開始找，找不到就從他的prototype找，再往上一層prototype找….，直到找到null (也就是到最後會找到<code>Object.prototype</code>的prototye為止)，而這一連串的prototype就是藉由prototype chain促成的！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">//Man.prototype = Person.prototype</span></span><br><span class="line"><span class="comment">//Man.prototype = new Person()</span></span><br></pre></td></tr></table></figure>
<p>而為何說上述範例中另外兩種方式不好呢？<br>首先若用<code>Man.prototype = Person.prototype</code>，此時兩者的prototype會參照到同一個物件！因此修改Man的prototype時也會影響到Person的prototype，是非常不好的做法，而且這樣一來其實就沒有必要多建立Man了是吧。</p>
<p>而<code>Man.prototype = new Person()</code>其實做的事跟<code>Object.create(Person.prototype)</code>幾乎是一樣的，差別在於使用new來呼叫Person此函式，這樣會有幾個缺點。</p>
<ul>
<li>使用<code>new</code> 會執行函式本身，可能會造成一些副作用(改變某些變數數值、logging、將this增加新的屬性等等)</li>
<li>若忘記加上<code>new</code>會污染到全域環境，有時這錯誤會很難發現</li>
</ul>
<p>因此會建議使用<code>Object.create(...)</code>，但此方法並非完全沒有壞處就是了，缺點在於他創造一個新的物件並拿來取代舊的，而不是去修改它，而將舊物件gc掉會使其效能也些微受到影響。不過這缺點其實非常微小就是了ＸＤ而在ES6中多了個新方法，<code>Object.setPrototypeOf(...)</code>將來或許可以就改用這做法。</p>
<h2 id="到此希望大家對JS中prototype-based的OO就有更多的瞭解了！"><a href="#到此希望大家對JS中prototype-based的OO就有更多的瞭解了！" class="headerlink" title="到此希望大家對JS中prototype-based的OO就有更多的瞭解了！"></a>到此希望大家對JS中prototype-based的OO就有更多的瞭解了！</h2><h1 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h1><p>在JS裡實現所謂的”類別”，到此我們可以知道兩種方法</p>
<ul>
<li><h4 id="使用class"><a href="#使用class" class="headerlink" title="使用class"></a>使用<code>class</code></h4></li>
<li><h4 id="使用-new"><a href="#使用-new" class="headerlink" title="使用 new"></a>使用 <code>new</code></h4></li>
</ul>
<h4 id="Constructor-Form"><a href="#Constructor-Form" class="headerlink" title="Constructor Form"></a>Constructor Form</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Foo.prototype.y = <span class="number">11</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bar</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Bar.prototype = <span class="built_in">Object</span>.create(Foo.prototype);</span><br><span class="line">Bar.prototype.z = <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> Bar();</span><br><span class="line">x.y + x.z;  <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<p>看了那麼多，JS物件導向的一個重點其實就是在於讓prototype連結，也就是物件間的連結，所以我們需要的其實只是物件而已！所以才有OLOO這個詞（Object Linking Other Objects）</p>
<ul>
<li><h4 id="使用Object-create"><a href="#使用Object-create" class="headerlink" title="使用Object.create(...)"></a>使用<code>Object.create(...)</code></h4><h4 id="OOLO-Form"><a href="#OOLO-Form" class="headerlink" title="OOLO Form"></a>OOLO Form</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> FooObj = &#123; y: <span class="number">11</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> BarObj = <span class="built_in">Object</span>.create(FooObj);</span><br><span class="line">BarObj.z = <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="built_in">Object</span>.create(BarObj);</span><br><span class="line">x.y + x.z;  <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>另一個例子，再加上<code>Object.assign()</code>來初始化物件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dog = &#123;</span><br><span class="line">  leg: <span class="number">4</span>,</span><br><span class="line">  bark: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'bark! bark! bark!'</span>) &#125;,</span><br><span class="line">  des: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log( <span class="keyword">this</span>.name + <span class="string">' - '</span> + <span class="keyword">this</span>.color)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> huskies = <span class="built_in">Object</span>.assign(&#123;&#125;,<span class="built_in">Object</span>.create(dog), &#123;name: <span class="string">"Max"</span>&#125;, &#123;color: <span class="string">"black"</span>&#125;);</span><br><span class="line"><span class="comment">//var huskies = Object.create(dog);</span></span><br><span class="line"><span class="comment">//huskies.name = "Max";</span></span><br><span class="line"><span class="comment">//huskies.color = "black";</span></span><br><span class="line"><span class="comment">//or</span></span><br><span class="line"><span class="comment">//var huskies = Object.create(dog,&#123;</span></span><br><span class="line"><span class="comment">//  name: &#123;value: "Max", enumerable: true&#125;,</span></span><br><span class="line"><span class="comment">//  color: &#123;value: "black", enumerable: true&#125;</span></span><br><span class="line"><span class="comment">//&#125;)</span></span><br></pre></td></tr></table></figure></p>
<p>若我們需要產生多個物件的時候，每次都打那麼一長串不是很麻煩嗎？可以用factory function來減少程式碼</p>
<h4 id="factory-function"><a href="#factory-function" class="headerlink" title="factory function"></a>factory function</h4><p>若一個函式會創造並且回傳一個物件的話，當他並不是用<code>new</code>去使用時，我們稱它為factory function<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dog = &#123;</span><br><span class="line">  leg: <span class="number">4</span>,</span><br><span class="line">  bark: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'bark! bark! bark!'</span>) &#125;,</span><br><span class="line">  des: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log( <span class="keyword">this</span>.name + <span class="string">' - '</span> + <span class="keyword">this</span>.color)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> huskiesFactory = <span class="function"><span class="keyword">function</span>(<span class="params">name, color</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;,<span class="built_in">Object</span>.create(dog),&#123;</span><br><span class="line">    name: name,</span><br><span class="line">    color: color</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> max = huskiesFactory(<span class="string">'Max'</span>, <span class="string">'black'</span>)</span><br></pre></td></tr></table></figure></p>
<h4 id="mixins-Concatenative-inheritance"><a href="#mixins-Concatenative-inheritance" class="headerlink" title="mixins (Concatenative inheritance)"></a>mixins (Concatenative inheritance)</h4><p>不是連接物件而是去複製物件<br>不只能一次和一個物件連接，可以一次組合多個物件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = &#123;  </span><br><span class="line">    who: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.name; &#125;,</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> canSpeak = &#123;  </span><br><span class="line">    speak: <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123; <span class="built_in">console</span>.log(<span class="keyword">this</span>.who() + <span class="string">": "</span> + s); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> canWalk = &#123;  </span><br><span class="line">    walk: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="keyword">this</span>.who() + <span class="string">" is walking..."</span>); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> canRun = &#123;</span><br><span class="line">    run: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="keyword">this</span>.who() + <span class="string">" is running..."</span>); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> max = <span class="built_in">Object</span>.assign(&#123;&#125;, Person, canSpeak, canWalk, canRun);</span><br><span class="line"></span><br><span class="line">max.init(<span class="string">"Max"</span>);</span><br><span class="line">max.speak(<span class="string">"Hello!"</span>);</span><br><span class="line">max.walk();</span><br><span class="line">max.run();</span><br></pre></td></tr></table></figure></p>
<h1 id="參考與推薦連結"><a href="#參考與推薦連結" class="headerlink" title="參考與推薦連結"></a>參考與推薦連結</h1><p>本文，為了方便敘述簡化了很多東西，以下連結能了解更詳盡的內容<br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create" target="_blank" rel="external">Object.create</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="external">Object.assign</a><br><a href="http://www.datchley.name/understanding-prototypes-delegation-composition/" target="_blank" rel="external">Understanding Prototypes, Delegation &amp; Composition</a><br><a href="https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a#.t9hbls1dn" target="_blank" rel="external">Common Misconceptions About Inheritance in JavaScript</a><br><a href="https://medium.com/javascript-scene/the-heart-soul-of-prototypal-oo-concatenative-inheritance-a3b64cb27819#.aii05xq0e" target="_blank" rel="external">The Heart &amp; Soul of Prototypal OO: Concatenative Inheritance</a></p>

        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://tancc.github.io/blog/blog/2016/01/24/javascript-oo/" data-id="ciqmjldhq000773ejy922kpm8" class="article-share-link">Share</a>
      
        <a href="http://tancc.github.io/blog/blog/2016/01/24/javascript-oo/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2016/01/26/ec2同步本地端檔案/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ec2同步本地端檔案
        
      </div>
    </a>
  
  
    <a href="/blog/2016/01/20/javascript常見誤區/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Javascript常見誤區</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/aws/">aws</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/ec2/">ec2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/haskell/">haskell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/javasript/">javasript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/react-router/">react-router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/redux/">redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/aws/" style="font-size: 15px;">aws</a> <a href="/blog/tags/ec2/" style="font-size: 15px;">ec2</a> <a href="/blog/tags/haskell/" style="font-size: 10px;">haskell</a> <a href="/blog/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/blog/tags/javasript/" style="font-size: 10px;">javasript</a> <a href="/blog/tags/linux/" style="font-size: 15px;">linux</a> <a href="/blog/tags/react/" style="font-size: 10px;">react</a> <a href="/blog/tags/react-router/" style="font-size: 10px;">react-router</a> <a href="/blog/tags/redux/" style="font-size: 10px;">redux</a> <a href="/blog/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/01/">一月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2016/07/14/more_about_object/">物件相關的更多行為</a>
          </li>
        
          <li>
            <a href="/blog/2016/07/10/haskell-note/">haskell_note</a>
          </li>
        
          <li>
            <a href="/blog/2016/02/25/learn-redux/">Redux筆記</a>
          </li>
        
          <li>
            <a href="/blog/2016/02/23/quick-es6/">ES6常用特性快速瀏覽</a>
          </li>
        
          <li>
            <a href="/blog/2016/02/14/react-router-context/">react-router無法使用context</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Tan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/blog" class="mobile-nav-link">Home</a>
  
    <a href="/blog/blog/archives" class="mobile-nav-link">Archives</a>
  
    <a href="https://github.com/tancc" class="mobile-nav-link">Github</a>
  
</nav>
    
<script>
  var disqus_shortname = 'tansnote';
  
  var disqus_url = 'http://tancc.github.io/blog/blog/2016/01/24/javascript-oo/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>
</body>
</html>